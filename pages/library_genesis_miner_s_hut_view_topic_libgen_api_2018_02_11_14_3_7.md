<a href="https://genofond.org/viewtopic.php?f=17&t=6874&sid=4c8d658923b913f7dfe3281a3b30ebc2">https://genofond.org/viewtopic.php?f=17&t=6874&sid=4c8d658923b913f7dfe3281a3b30ebc2</a><div id="articleHeader"><h1>Барак старателей • View topic</h1></div>(for an English translation refer to the second half of this post)<br /><br />По просьбе трудящихся написал фичу:<br /><a href="http://gen.lib.rus.ec/json.php" target="_blank">http://gen.lib.rus.ec/json.php</a><br /><a href="http://libgen.org/json.php" target="_blank">http://libgen.org/json.php</a><br />возвращает данные в формате json.<br /><br />как работает:<br />возврат данных о произвольных книгах:<br />Параметры:<br />ids - ID книги на сайте (перечислить через запятую, если несколько)<br />fields - поля описания (только таблица updated, таблица description не задействована), перечислять через запятую<br />допустимые поля <div><div><a href="#" target="_blank">show</a></div></div>пример: <a href="http://libgen.org/json.php?ids=1,2&fields=Author,Title" target="_blank">http://libgen.org/json.php?ids=1,2&fields=Author,Title</a><br />(получаем поля Author,Title для книг с ID 1,2)<br /><br />Последнее добавленное\измененное<br />Параметры<br />mode - последнее добавленное или последнее измененное. Допустимые значения  - last , mode или modified<br />timelast - дата с. Формат - 0000-00-00<br />timefirst - дата по. Формат - 0000-00-00, если не указана, по умолчанию берется до сегодняшнего дня<br /><br />пример: <a href="http://libgen.org/json.php?fields=ID&timefirst=2013-05-01&timelast=2013-05-05&mode=last" target="_blank">http://libgen.org/json.php?fields=ID&ti ... &mode=last</a><br />(получаем поля ID для записей добавленных с 2013-05-01 по 2013-05-05)<br /><br />Параметры количество возвращаемых записей<br /><br />limit1 - если limit1 не указан, то по умолчанию 1000<br />limit2 - по умолчанию не задается<br />если задан и limit1 и limit2, то первый указывает на начало первой возвращаемой строки, а второй задает максимальное количество возвращаемых строк,<br />если задан только limit1 то возвращается просто первые N строк запроса (фактически это SQL запрос<br />SELECT .... LIMIT `limit1`, `limit2` или SELECT .... LIMIT `limit1`)<br /><br />пример<br /><a href="http://libgen.org/json.php?fields=Author,Title&limit1=10&limit2=10&mode=last&timefirst=2013-05-01" target="_blank">http://libgen.org/json.php?fields=Autho ... 2013-05-01</a><br />(получаем поля Author,Title для 10 записей начиная с 10 строки добавленных начиная с 2013-05-01)<br /><br /><br />13.01.2013<br />добавлен новый режим newer<br /><br />Параметры<br />mode = newer<br />timenewer - время последней имеющейся локально записи в формате '2012-12-31 23:59:59'<br />idnewer - ID последней имеющейся локально записи для данной метки времени.<br /><br />Записи возвращаются отсортированными в порядке TimeLastModified ASC, ID ASC.<br /><br />Возвращаются только те записи, дата которых строго больше указанных параметров. Дополнительное поле idnewer необходимо по той причине, что довольно много записей может иметь одинаковое время изменения (такое бывает при пакетных правках).<br /><br />Данный режим позволяет легко обновлять локальную базу независимо от того, сколько записей возвращает каждый отдельный запрос (сейчас максимум 1000 записей). Чтобы получить все новые записи, достаточно просто повторять запрос в цикле, каждый раз указывая параметры последней полученной записи из предыдущего результата в качестве параметров timenewer и idnewer для нового запроса. Окончанием цикла будет состояние, когда очередной запрос возвращает пустой массив.<br /><br />Примеры<br /><br />Получить все записи, новее чем '2013-12-21 06:23:56', с учётом последнего ID 944088:<br /><a href="http://libgen.org/json.php?fields=%2A&timenewer=2013-12-21+06%3A23%3A56&idnewer=944088&mode=newer" target="_blank">http://libgen.org/json.php?fields=%2A&t ... mode=newer</a><br />Для этой метки времени записей больше чем 1000, потому следующий запрос надо продолжать с той же датой и новым ID 971319:<br /><a href="http://libgen.org/json.php?fields=%2A&timenewer=2013-12-21+06%3A23%3A56&idnewer=971319&mode=newer" target="_blank">http://libgen.org/json.php?fields=%2A&t ... mode=newer</a><br /><br />Получить все записи, новее чем '2013-12-21 06:23:56', начиная с минимального имеющегося значения ID для этой даты (ID указываем 0):<br /><a href="http://libgen.org/json.php?fields=%2A&timenewer=2013-12-21+06%3A23%3A56&idnewer=0&mode=newer" target="_blank">http://libgen.org/json.php?fields=%2A&t ... mode=newer</a><br />(такие запросы будут давать перекрытие, если в локальной базе уже есть записи с выбранным временем)<br /><br />Если idnewer не указать, то будут возвращены те записи, дата которых строго больше чем timenewer<br /><a href="http://libgen.org/json.php?fields=%2A&timenewer=2013-12-21+06%3A23%3A56&mode=newer" target="_blank">http://libgen.org/json.php?fields=%2A&t ... mode=newer</a><br /><br />______________________________________________________________<br /><br />English translation by fondogen<br /><br />At the request of workers:<br /><br /><a href="http://gen.lib.rus.ec/json.php" target="_blank">http://gen.lib.rus.ec/json.php</a><br /><a href="http://libgen.org/json.php" target="_blank">http://libgen.org/json.php</a><br /><br />which return data from the `updated` table in JSON format.<br /><br />how it works:<br /><br />1. Specific fields of arbitrary books.<br /><br />parameters:<br /><br />ids - (comma separated) libgen book ID(s)<br />fields - fields description (only table `updated`, table `description` not involved), with commas<br /><br />allowable fields:<br /><br />('ID', 'Title', 'VolumeInfo', 'Series', 'Periodical', 'Author', 'Year',<br />'Edition', 'Publisher', 'City', 'Pages', 'Language', 'Topic', 'Library',<br />'Issue', 'Identifier', 'ISSN', 'ASIN', 'UDC', 'LBC', 'DDC', 'LCC', 'Doi',<br />'Googlebookid', 'OpenLibraryID', 'Commentary', 'DPI', 'Color', 'Cleaned',<br />'Orientation', 'Paginated', 'Scanned', 'Bookmarked', 'Searchable', 'Filesize',<br />'Extension', 'MD5', 'CRC32', 'eDonkey', 'AICH', 'SHA1', 'TTH', 'Generic',<br />'Filename', 'Visible', 'Locator', 'Local', 'TimeAdded', 'TimeLastModified',<br /> 'Coverurl','identifierwodash', 'tags','pagesinfile', 'descr', 'toc', 'tth', 'sha1', 'aich', 'btih', 'torrent', 'crc32')<br /><br />Example: <a href="http://libgen.org/json.php?ids=1,2&fields=Author,Title" target="_blank">http://libgen.org/json.php?ids=1,2&fields=Author,Title</a><br /><br />(returns Author and Title for books with ID 1 and 2)<br /><br />2. Latest uploads and altered rows.<br /><br />parameters:<br /><br />mode      - recently added or last modified.<br /><br />Valid values: 'last', 'mode' or 'modified'.<br /><br />timelast  - to date. Format - 0000-00-00<br />timefirst - to date. Format - 0000-00-00 (default: current day)<br /><br /><a href="http://libgen.org/json.php?fields=ID&timefirst=2013-05-01&timelast=2013-05-05&mode=last" target="_blank">http://libgen.org/json.php?fields=ID&timefirst=2013-05-01&timelast=2013-05-05&mode=last</a><br /><br />(returns ID field for records added from 05/01/2013 to 05/05/2013)<br /><br /><br />3. Record count limits.<br /><br />Parameters:<br /><br />limit1 - limit1 (default 1000)<br />limit2 - (no default value)<br /><br />If both limit1 and limit2, limit1 indicates first row to return, limit2 indicates maximum row count.<br />If only limit1 returns just the first N rows of query.<br />Literally, (SELECT .... LIMIT `limit1`,` limit2` or SELECT .... LIMIT `limit1`).<br /><br /><br />Example:<br /><br /><a href="http://libgen.org/json.php?fields=Author,Title&limit1=10&limit2=10&mode=last&timefirst=2013-05-01" target="_blank">http://libgen.org/json.php?fields=Author,Title&limit1=10&limit2=10&mode=last&timefirst=2013-05-01</a><br /><br />(fields Author, Title 10 records for starting with 10 lines added since 05.01.2013)<br /><br />13/01/2013<br /><br />4. incremental synchronisation of local table with remote.<br /><br />parameters:<br /><br />mode = '*newer'<br /><br />timenewer - latest local record timestamp, iso8601 format: '2012-12-31 23:59:59'.<br />idnewer   - ID latest available local entries for this timestamp.<br /><br />returns records sorted as TimeLastModified ASC, ID ASC.<br /><br />Returns only those records whose date is strictly greater than the<br />specified parameters. Additional field idnewer necessary for the<br />reason that a lot of records may have the same modification time<br />(this happens when batch editing).<br /><br />This mode allows easy update of a local database, regardless<br />of how many records are returned every single request (current limit 1000). <br />To get all the new entries, simply repeat the request in a loop, each time <br />specifying the parameters of the last received records from the previous <br />result as parameters 'timenewer' and 'idnewer' for the new request. The end <br />of the cycle will be the state when the query returns fewer than 1000 records.<br />This removes need to provide diff table updates in dbdump/.<br /><br />Examples:<br /><br />Get all entries newer than '12/21/2013 6:23:56', taking into account<br />the last ID 944088:<br /><br /><a href="http://libgen.org/json.php?fields=%2A&timenewer=2013-12-21+06%3A23%3A56&idnewer=944088&mode=newer" target="_blank">http://libgen.org/json.php?fields=%2A&timenewer=2013-12-21+06%3A23%3A56&idnewer=944088&mode=newer</a><br /><br /><br />mode = newer For this time stamp records more than 1000 because the<br />following query should continue on the same date and the new ID<br />971319:<br /><br /><a href="http://libgen.org/json.php?fields=%2A&timenewer=2013-12-21+06%3A23%3A56&idnewer=971319&mode=newer" target="_blank">http://libgen.org/json.php?fields=%2A&timenewer=2013-12-21+06%3A23%3A56&idnewer=971319&mode=newer</a><br /><br /><br />Get all entries newer than '12/21/2013 6:23:56', starting with the<br />minimum value of the existing ID for this date (ID specify 0):<br /><br /><a href="http://libgen.org/json.php?fields=%2A&timenewer=2013-12-21+06%3A23%3A56&idnewer=0&mode=newer" target="_blank">http://libgen.org/json.php?fields=%2A&timenewer=2013-12-21+06%3A23%3A56&idnewer=0&mode=newer</a><br /><br />(such requests will be given the overlap, if the local database is<br />already recording the selected time)<br /><br /><br />If idnewer not specified, will be returned to the records, the date<br />of which is strictly greater than timenewer<br /><br /><a href="http://libgen.org/json.php?fields=%2A&timenewer=2013-12-21+06%3A23%3A56&mode=newer" target="_blank">http://libgen.org/json.php?fields=%2A&timenewer=2013-12-21+06%3A23%3A56&mode=newer</a>