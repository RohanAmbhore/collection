<a href="https://codeburst.io/how-to-call-api-in-a-smart-way-2ca572c6fe86">https://codeburst.io/how-to-call-api-in-a-smart-way-2ca572c6fe86</a><div id="articleHeader"><h1>How to make API calls in a smart way</h1></div><p id="9ad3"><em>By keeping all the endpoints in globally shared file</em></p><p id="f567">While developing a web application, we have to make some APIs calls in order to get or update the data we are using. Usually, the calls are called directly into the code, for example.</p><pre id="71a5">//some Posts.js file, it can be a React/Angular/Vue component</pre><pre id="d007">... some stuff</pre><pre id="37f6">fetchPosts() { return axios.get('/posts') }</pre><p id="fc1a">That is a classic snippet where, by using the well know library axios, we are making an API call directly into the component code.</p><p id="d0f3">It may happen that in another file we need to do the exactly same request so we just use the same code</p><pre id="70cb">//another .js file, it can be a React/Angular/Vue component</pre><pre id="a709">... some stuff</pre><pre id="f7a1">fetchPostsAgain() { return axios.get('/posts') }</pre><p id="0dbf">Usually, developers love copy and paste. This a common situation with redundant code. So if something change in the server, we need to update two functions in two files: that is inconvenient.</p><h3 id="be44">Solution #1</h3><p id="4deb">Easily, a correct thing to do is to create a file, called api.js where we store a big object with all the endpoints URLS</p><pre id="d657">//api.js</pre><pre id="b1c7">export default {</pre><pre id="ce5d">    posts: '/posts'</pre><pre id="740e">}</pre><p id="00da">Then we can</p><pre id="cfdf">//some Posts.js file, it can be a React/Angular/Vue component</pre><pre id="35f6">import api from './api'</pre><pre id="04d1">... some stuff</pre><pre id="495e">fetchPosts() { return axios.get(api.posts) }</pre><p id="0ad0">And similarly in the other file</p><pre id="960e">//another .js file, it can be a React/Angular/Vue component</pre><pre id="9118">import api from './api'</pre><pre id="587e">... some stuff</pre><pre id="f040">fetchPostsAgain() { return axios.get(api.posts) }</pre><p id="cb02">Now if we want to change the url, we can just edit one file. But, still, we have some shared code: the axios call.</p><h3 id="827d">Solution #2</h3><p id="0409">Let’s actually move all the logic behind calling our web server into the shared file</p><pre id="8169">export default {</pre><pre id="a9cd">posts(url) {<br />    return {<br />      getOne: ({ id }) =&gt; axios.get(`${url}/${id}`),<br />      getAll: () =&gt; axios.get(url),<br />      update: (toUpdate) =&gt;  axios.put(url,toUpdate),<br />      create: (toCreate) =&gt;  axios.put(url,toCreate),<br />      delete: ({ id }) =&gt;  axios.delete(`${url}/${id}`)<br />    }<br />  }<br />}</pre><p id="911c">Now we can just call <code>api.posts('posts').getAll()</code> in our code.</p><h3 id="a0c4">Solution #3</h3><p id="d326">We can now even expand solution#2 by creating an API class that will create the basic CRUD endpoints for us.</p><p id="6085">You can find the code here:</p><p id="c99f"><a href="https://github.com/FrancescoSaverioZuppichini/API-Class" target="_blank">https://github.com/FrancescoSaverioZuppichini/API-Class</a></p><figure id="cf76"><div><div><img src="https://cdn-images-1.medium.com/freeze/max/90/1*cTdSB_zkmVaEVJ0HIcx-nQ.png?q=20" /><div class="readableLargeImageContainer"><img src="https://cdn-images-1.medium.com/max/2000/1*cTdSB_zkmVaEVJ0HIcx-nQ.png" /></div><figcaption>I used a screenshot for better understanding since the syntax is highlighted</figcaption></figure><p id="8fc5">We can now easily create an API instance</p><pre id="3cf8">const myApi = new API({ url:'http://localhost:8080/api' })</pre><p id="bb3b">And then create all the correct handles for the <code>posts</code> entity with one line of code</p><pre id="4918">myApi.createEntity({ name: 'posts' })</pre><p id="eed9">Let’s try if it works! I have a web quote API running at <code>localhost:8080/api/posts</code></p><pre id="8e50">myApi.endpoints.posts.getAll()</pre><pre id="fd5c">.then(({ data }) =&gt; console.log(data))</pre><p id="8416">result</p><pre id="a855">Object {data: Array(4), meta: Object}</pre><p id="d969">Perfect! Let’s try to fetch one by id</p><pre id="416e">myApi.endpoints.posts.getOne({ id: 1})</pre><pre id="53dc">.then(({data}) =&gt; console.log(data))</pre><p id="645b">And the output</p><pre id="a9da">{ author: { id: 1, name: 'Henry Thoreau' },<br />  author_id: 1,<br />  created: 1500208099.04669,<br />  id: 1,<br />  tags: [],<br />  text: 'Things do not change, we change. ',<br />  totalLikes: 0,<br />  user:<br />   { google_id: '105140920994782382362',<br />     id: 1,<br />     profile_image: '<a href="https://lh6.googleusercontent.com/-IPkTcTumu4Y/AAAAAAAAAAI/AAAAAAAAAAA/AI6yGXxYIjcZrpi_07v27U32SuXjBTAPCg/s96-c/photo.jpg%27" target="_blank">https://lh6.googleusercontent.com/-IPkTcTumu4Y/AAAAAAAAAAI/AAAAAAAAAAA/AI6yGXxYIjcZrpi_07v27U32SuXjBTAPCg/s96-c/photo.jpg'</a>,<br />     user_name: 'Fra Zuppi' },<br />  user_id: 1 }</pre><p id="eedf">We can also try to create/update and delete a post</p><pre id="1357">const post = { author: { id: 125, name: 'test' },<br />author_id: 125,<br />tags: [],<br />text: 'test',<br />user:<br /> { google_id: '105140920994782382362',<br />   id: 1,<br />   profile_image: '<a href="https://lh6.googleusercontent.com/-IPkTcTumu4Y/AAAAAAAAAAI/AAAAAAAAAAA/AI6yGXxYIjcZrpi_07v27U32SuXjBTAPCg/s96-c/photo.jpg%27" target="_blank">https://lh6.googleusercontent.com/-IPkTcTumu4Y/AAAAAAAAAAI/AAAAAAAAAAA/AI6yGXxYIjcZrpi_07v27U32SuXjBTAPCg/s96-c/photo.jpg'</a>,<br />   user_name: 'Fra Zuppi' },<br />user_id: 1 }</pre><pre id="dc53">myApi.endpoints.posts.create(post)<br />.then(({ data }) =&gt; myApi.endpoints.posts.update(data))<br />.then(({ data }) =&gt; myApi.endpoints.posts.delete(data))<br />.catch((err) =&gt; console.log(err))</pre><p id="35cf">Now check the server’s logs</p><figure id="9b5a"><div><img src="https://cdn-images-1.medium.com/max/2000/1*pmFs0a9pb2DYiiuqSvyjUQ.png" /></div></figure><p id="fb1d">Everything worked as expected. We have successfully create our endpoints for the <code>posts</code> entity.</p><h3 id="997a">Conclusion</h3><p id="de16">We have seen how we can improve our application’s code by just sharing global data into a global file. We have seen some solution about the problem and how to automatically create APIs call by using a util class.</p><p id="1653">I hope you like this article, let me know your feedbacks.</p><p id="3e68">Thank you for reading.</p><p id="c4fe">Francesco Saverio Zuppichini</p>