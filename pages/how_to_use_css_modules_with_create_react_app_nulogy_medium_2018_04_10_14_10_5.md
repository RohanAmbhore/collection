<a href="https://medium.com/nulogy/how-to-use-css-modules-with-create-react-app-9e44bec2b5c2">https://medium.com/nulogy/how-to-use-css-modules-with-create-react-app-9e44bec2b5c2</a><div id="articleHeader"><h1>How to Use CSS Modules with Create React App</h1></div><h2 id="14bc">Short answer: you can’t. You gotta ⏏</h2><figure id="0d72"><div><div><div class="readableLargeImageContainer"><img /></div><figcaption>📎 ⏏ 💿</figcaption></figure><p id="f475"><strong><em>Update January 18th, 2018:</em></strong><em> CSS Module support has landed in alpha builds of Create React App v2 </em>🎉<em>.</em></p><p id="0101"><em>This article remains for posterity. Also note it may help you figure out how to configure other custom webpack loaders and modules like SASS etc.</em></p></section><p id="94a6">Facebook’s <a href="https://github.com/facebookincubator/create-react-app/" target="_blank">Create React App</a> is a great way to get started on a new React project quickly. It supports a lot of sensible and popular defaults. But if you want to add unsupported functionality — a CSS preprocessor step like <a href="https://github.com/css-modules/css-modules" target="_blank">CSS Modules</a> for example—you’re going to have to <code>eject</code> and head out on your own.</p><p id="d4e4"><strong>This article will explain how to use CSS Modules in a Create React App … app.</strong></p><p id="617f">Starting a new project with Create React App (I’m just going to call it CRA for short) means you no longer have to manage a bunch of node modules and confusing Webpack configs. After installing CRA globally (<code>$ yarn global add create-react-app</code>) starting a new project is as easy as:</p><pre id="868b">$ create-react-app myApp<br />$ cd myApp/<br />$ yarn start</pre><p id="5391"><em>A nice detail is that CRA keeps itself updated so you shouldn’t ever need to manually update the global </em><code><em>create-react-app</em></code><em> package.</em></p><h3 id="49c1">Go your own way</h3><p id="98af">You get a lot of power from those little commands. Unfortunately, if you want to do anything outside of what CRA provides you’ll have to go your own way.</p><figure id="68d3"><div><div><img src="https://cdn-images-1.medium.com/freeze/max/105/1*CZhffWkWQWUL92QdS8jRpg.jpeg?q=20" /><div class="readableLargeImageContainer"><img /></div></div></div><figcaption><a href="https://open.spotify.com/album/1bt6q2SruMsBtcerNVtpZB" target="_blank">Rumours</a> are that the `eject` command was almost called `<a href="https://genius.com/Fleetwood-mac-the-chain-lyrics#note-2986257" target="_blank">break-the-chain</a>`</figcaption></figure><h4 id="46bc">the `eject` command ⏏</h4><p id="653c">Create React App comes with a handy little command for those of us that have our own opinions about the ingredients of a great React setup: the <code>eject</code> command:</p><pre id="5deb">$ yarn eject</pre><p id="f621">The Create React App README is pretty clear about the pros and cons of ejecting:</p><blockquote id="4c39"><strong>Note: this is a one-way operation. Once you </strong><code><strong>eject</strong></code><strong>, you can’t go back!</strong></blockquote><blockquote id="6f63">If you aren’t satisfied with the build tool and configuration choices, you can <code>eject</code> at any time. This command will remove the single build dependency from your project.</blockquote><blockquote id="1aed">Instead, it will copy all the configuration files and the transitive dependencies (Webpack, Babel, ESLint, etc) right into your project so you have full control over them. All of the commands except <code>eject</code> will still work, but they will point to the copied scripts so you can tweak them. At this point you’re on your own.</blockquote><blockquote id="a73b">You don’t have to ever use <code>eject</code>. The curated feature set is suitable for small and middle deployments, and you shouldn’t feel obligated to use this feature. However we understand that this tool wouldn’t be useful if you couldn’t customize it when you are ready for it.</blockquote><blockquote id="e405"><a href="https://github.com/facebookincubator/create-react-app/blob/master/packages/react-scripts/template/README.md#npm-run-eject" target="_blank">https://github.com/facebookincubator/create-react-app/blob/master/packages/react-scripts/template/README.md#npm-run-eject</a></blockquote><p id="d2e6">I suggest you read that carefully and decide if you are ready to make the split.</p><h3 id="b76d">Here’s what happens when you eject</h3><pre id="3498">$ yarn eject<br /><strong>Are you sure you want to eject? This action is permanent. [y/N]</strong><br />&gt; y<br />Ejecting...</pre><pre id="fc05">Copying files into /Users/user/src/myApp</pre><p id="ca12">This replaces your project’s single dependency on <code>react-scripts</code> with the plethora of packages CRA depends on. It also moves some scripts and configurations into your project. Now you have full control of your project.</p><p id="b708">Running a Git status on your project after running <code>yarn eject</code> shows the affected files and directories:</p><pre id="d784">$ git status</pre><pre id="fd75"><strong>Changes not staged for commit:</strong><br /> modified:   package.json</pre><pre id="a607"><strong>Untracked files:</strong><br /> config/<br /> scripts/</pre><p id="efef">Commit those changes and you are ready to configure <strong>CSS Modules.</strong></p><h3 id="7983">CSS Modules</h3><p id="801b">I’m not going to tell you how great CSS Modules are. I assume you’re already enlightened. <a href="https://glenmaddern.com/articles/css-modules" target="_blank">If not read this</a>. It has the best illustrations:</p><figure id="9af9"><div><div><img src="https://cdn-images-1.medium.com/freeze/max/105/1*2vnZvBXrYL1l_Lfw8mWWbg.jpeg?q=20" /><div class="readableLargeImageContainer"><img /></div></div></div><figcaption>We no longer have to think this intensely about CSS.</figcaption></figure><p id="b15e">Let’s just hop right in and get CSS Modules installed right?</p><h4 id="cc74">Installing CSS Modules</h4><p id="e0a8">Lucky us! It turns out the project generated by ejecting from CRA includes all the node modules we need to get CSS Modules running in Webpack. We don’t need to install any additional dependencies!</p><h4 id="b8af">Configuring CSS Modules</h4><p id="d271">Find the <code>css-loader</code> section in your Webpack dev config (<code>config/webpack.config.dev.js:186</code> at the time of writing) and change the <code>options</code> portion as so:</p><pre id="2f06"><em>// before</em><br />{<br />  loader: require.resolve('css-loader'),<br />  options: {<br />    importLoaders: 1,<br />  },<br />},</pre><pre id="3e9e"><em>// after</em><br />{<br />  loader: require.resolve('css-loader'),<br />  options: {<br />    importLoaders: 1,<br />  <strong>  modules: true,<br />    localIdentName: "[name]__[local]___[hash:base64:5]"  </strong><br />  },<br />},</pre><p id="620e">Do the same in your Webpack production config (<code>config/webpack.config.prod.js:191</code>):</p><pre id="4ab7"><em>// before<br /></em>{<br />  loader: require.resolve('css-loader'),<br />  options: {<br />    importLoaders: 1,<br />    minimize: true,<br />    sourceMap: true,<br />   },<br />},</pre><pre id="7834"><em>// after</em><br />{<br />  loader: require.resolve('css-loader'),<br />  options: {<br />    importLoaders: 1,<br />    <strong>modules: true,</strong><br />    minimize: true,<br />    sourceMap: true,<br />   },<br />},</pre><p id="5c99"><em>Note: you can leave the </em><code>localIdentName</code><em> out of your production config and you’ll get the </em><a href="https://github.com/webpack-contrib/css-loader#options" target="_blank"><em>default class name format which is just an ugly </em></a><code><a href="https://github.com/webpack-contrib/css-loader#options" target="_blank"><em>[hash:base64]</em></a></code><a href="https://github.com/webpack-contrib/css-loader#options" target="_blank"><em>.</em></a></p><p id="8d67"><strong>And … that’s it!</strong></p><p id="9b93">If you run <code>yarn start</code> now you will see that your app is now completely unstyled. Paradoxically that means its working.</p><h4 id="1922">Update your classNames to use CSS Modules</h4><p id="55b8">Your app is looking so <a href="http://brutalistwebsites.com" target="_blank">brutalist</a> because now you <em>actually have to use CSS Modules in your components</em>. To get started just open your components, and make a few changes:</p><ol><li id="26e8">Assign imported stylesheets to a local constant <code>import styles from './SomeComponent.css'</code> .</li><li id="35f0">Replaces the <code>className</code> strings in your JSX with object indexes <code>className={styles.myClass}</code>.</li><li id="a674">CSS Modules don’t allow dashes (“-” ) in class names so you will have to update any classes that use a dash. You’ll have to make this change both in the CSS and in the JSX, but a nice bonus is that your class names will be simpler — <code>.App-header</code> becomes just <code>.header</code> for example.</li></ol><p id="e5f7">Here’s what the <strong>App </strong>component <code>src/App.jsx</code> looks like:</p><h4 id="fd77">Before CSS Modules:</h4><pre id="68aa">import React, { Component } from 'react';<br />import logo from './logo.svg';<br /><strong>import './App.css';</strong></pre><pre id="8d37">class App extends Component {<br />  render() {<br />    return (<br />      &lt;div <strong>className="App"</strong>&gt;<br />        &lt;div <strong>className="App-header"</strong>&gt;<br />          &lt;img src={logo} <strong>className="App-logo"</strong> alt="logo" /&gt;<br />          &lt;h2&gt;Welcome to React&lt;/h2&gt;<br />        &lt;/div&gt;<br />        &lt;p <strong>className="App-intro"</strong>&gt;<br />          To get started, edit &lt;code&gt;src/App.js&lt;/code&gt; and save to reload.<br />        &lt;/p&gt;<br />      &lt;/div&gt;<br />    );<br />  }<br />}</pre><pre id="0091">export default App;</pre><h4 id="0c26">After CSS Modules:</h4><pre id="5244">import React, { Component } from 'react';<br />import logo from './logo.svg';<br /><strong>import styles from './App.css';</strong></pre><pre id="ffcf">class App extends Component {<br />  render() {<br />    return (<br />      &lt;div <strong>className={styles.App}</strong>&gt;<br />        &lt;div <strong>className={styles.header}</strong>&gt;<br />          &lt;img src={logo} <strong>className={styles.logo}</strong> alt="logo" /&gt;<br />          &lt;h2&gt;Welcome to React&lt;/h2&gt;<br />        &lt;/div&gt;<br />        &lt;p <strong>className={styles.intro}</strong>&gt;<br />          To get started, edit &lt;code&gt;src/App.js&lt;/code&gt; and save to reload.<br />        &lt;/p&gt;<br />      &lt;/div&gt;<br />    );<br />  }<br />}</pre><pre id="6de0">export default App;</pre><h3 id="9a3d">You’re on your own now</h3><p id="9fbd">You’re done! No more Create React App. Now you are free to use whatever CSS Preprocessor your want. You’re a grown up now.</p><p id="dcb8">If you aren’t ready to eject yet, I know of <a href="https://medium.com/@kitze/configure-create-react-app-without-ejecting-d8450e96196a#.a24vx9ke1" target="_blank">at least one other approach</a> that allows you to add CSS Module support without ejecting. But this adds another dependency to your project which goes against the point of sticking with CRA.</p><p id="2cc5">I hope this little tip was helpful to you. Or at least made you less afraid to <code>eject</code>. And of course, If you know of a better way to use CSS Modules with Create React App let me know in the comments!</p><h4 id="0bb1">Further reading</h4>