<a href="https://medium.com/tribalscale/tutorial-on-testing-react-part-1-2c587e39114d">https://medium.com/tribalscale/tutorial-on-testing-react-part-1-2c587e39114d</a><div id="articleHeader"><h1>Tutorial on Testing React with TDD — Part 1</h1></div><p id="355b">By Lawton Spelliscy</p><p id="50d1">Over the past few years, React has been widely adopted for new web applications. The benefits of React are numerous, including the ease of testing your basic UI elements. In this blog post, I’ll be showing you some basic examples for testing your code.</p><h3 id="2de4">Test Driven Development (TDD)</h3><p id="a664">At TribalScale, we use a TDD approach when writing our tests. This method basically means we write the tests for a piece of functionality prior to writing the code that implements said functionality. Now, I will admit that this can feel unintuitive and cumbersome at times, but there are numerous benefits. Because code is written to pass tests, instead of tests written to pass code, the code tends to be more modular and easier to test. TDD also forces you to define the purpose of each function more concretely.</p><h3 id="da42">Getting started</h3><p id="83ac"><em>All the code used in this example are available </em><a href="https://github.com/Lawton/react-testing-example" target="_blank"><em>here</em></a><em>.</em></p><p id="4c4d"><em>If you’d like to follow along with the example, I created a branch that has the </em><a href="https://github.com/Lawton/react-testing-example/tree/initial" target="_blank"><em>initial code setup</em></a><em> prior to my example.</em></p><h3 id="61d5">The Stack</h3><p id="5275">For the base of this project I used <a href="https://github.com/TribalScale/react-starter-kit" target="_blank">TribalScale’s React Starter Kit</a> and tried to minimize the requirements for the simplest React application.</p><h4 id="d535">Base Library:</h4><p id="6b59">React, of course!</p><h4 id="c06a">Test Libraries:</h4><p id="8845"><strong>Mocha: </strong>Testing Framework, used to run tests and show the results.</p><p id="b405"><strong>Chai: </strong>Assertion Library, used to determine under what conditions a test will pass.</p><p id="6e89"><strong>Sinon: </strong>Mocking Utility, used to mock functions to isolate code and mimic test scenarios.</p><p id="d947"><strong>Enzyme: </strong>React Testing Utility, used to mount React components on a virtual DOM, which allows you to interact with the React component without actually rendering the component in a browser.</p><p id="0097">I chose to use Mocha, Chai, and Sinon instead of Facebook’s Jest. I’ve used both approaches and personally, I found Jest a bit too slow and the auto-mocking feature a tad overkill. Furthermore, I find having to manually mock functions and objects with Sinon forces you to think more on how you will mimic a test scenario.</p><p id="0814">I chose Enzyme over React Test Utils because the API is a lot cleaner.</p><h4 id="9318">Other Libraries:</h4><p id="78fa"><strong>Babel: </strong>Convert ES6 to ES5 syntax</p><p id="6a95"><strong>Webpack: </strong>JS bundler</p><p id="db29"><strong>React-Dom: </strong>Adependency library for Enzyme used to manually render a React component into DOM</p><p id="530f"><strong>React-test-renderer: </strong>Dependency library for Enzyme</p><h3 id="6c6d">Basic Scenario</h3><p id="fe42">For this testing example, I used a very basic web application for simulating a calculator application. The basics of the UI have already been created: a user can type into the input field and there’s an ‘=’ button, but there‘s no functionality behind them. The first functionality that we will be adding with TDD is as follows:</p><p id="0ab8"><strong>Given: </strong>Numerical values separated by ‘+’ symbols are entered in the equation field</p><p id="87b9"><strong>When: </strong>User clicks the ‘=’ button</p><p id="9d27"><strong>Then: </strong>Sum of all numerical values should display to the right of the ‘=’ button</p><h3 id="f28d">Utility</h3><h4 id="ea49">Test # 1:</h4><p id="0408">First, let’s start with the functionality behind the UI. The input is a string with numerical values and ‘+’ symbols separating them. Our first step is to make the utility function that takes that input and returns the sum of the numeric values.</p><p id="ed18">Using the Chai expect library and Mocha’s describe/it syntax, we are testing whether our utility function <em>parseEquation</em> returns 2 when we input ‘1+1’. Before implementing the functionality, we run the test to confirm if the test is actually failing. This helps us avoid false positives.</p><figure id="8aa5"><div><div><img src="https://cdn-images-1.medium.com/freeze/max/105/0*OG0cz8I4tGA-Lc0a.?q=20" /><div class="readableLargeImageContainer"><img src="https://cdn-images-1.medium.com/max/2000/0*OG0cz8I4tGA-Lc0a." /></div></figure><h4 id="f303">Implementation # 1:</h4><p id="2427">The project has already set up a package.json script to run Mocha. The command runs all files ending with ‘_test’ with the extension ‘.js’ or ‘.jsx’. It also uses Babel compiler to allow for ES6 syntax. To run, simply run the command ‘npm test’. As you can see, our test is currently failing as we have not yet implemented the function. Here is a basic implementation:</p><p id="a59e">Now if we run our tests, we can see that they are still not passing.</p><figure id="6e72"><div><div><img src="https://cdn-images-1.medium.com/freeze/max/105/0*LTj7f8PyybdVuqb-.?q=20" /><div class="readableLargeImageContainer"><img src="https://cdn-images-1.medium.com/max/2000/0*LTj7f8PyybdVuqb-." /></div></figure><p id="3b81">The issue is that we are trying to add strings together, resulting in concatenations instead of a summation. Let’s try again.</p><p id="7d00">If we run our test again, we can see it’s starting to pass.</p><h4 id="9b4b">Test # 2:</h4><p id="444e">After we implemented the logic, the next step is to attach the UI element. Since we already confirmed that the <em>parseEquation</em> function works, we need to verify if the input will send to our new <em>parseEquation</em> function when a user selects the ‘=’ button.</p><p id="dd26">Here I am using Sinon to mock the <em>parseEquation</em> function in my math utility library. I mock the function in <em>beforeEach</em> and restore it in <em>afterEach</em>. These functions are provided by Mocha and take a description and a callback function that will be executed before and after each <em>it</em> inside of my <em>describe</em>. This assures that each of my mock implementations will be reinitialized and not affect any other test scenarios. It is very important to restore the mocked function. Otherwise, it will be mocked in other test suites as well.</p><p id="7522">I then use <em>shallow</em> from the Enzyme library to initialize my calculator component in a virtual DOM. I then simulate clicking the one button in the component and assert that my <em>parseEquation</em> was called with the correct input.</p><p id="d3d0">Again, we will run the tests to confirm they are failing.</p><h4 id="dc49">Implementation # 2:</h4><p id="a386">We then implement the fix.</p><p id="caeb">When we click the ‘=’ button, we are now calling the <em>parseEquation</em> and passing the equation’s contents to our <em>parseEquation</em> function. Running the tests again should result in a pass.</p><h4 id="081c">Test # 3:</h4><p id="d5e1">We are passing the value. Now we need to make sure we display the result of <em>parseEquation</em>.</p><p id="2131">Here I am using Sinon to set what the <em>parseEquation</em> will return. The reason I confidently can mock <em>parseEquation</em> is because I already tested its functionality previously. I simulate the click and confirm that my new result field is now displaying the same value. When we run the test for the first time, we’ll get an error like this:</p><figure id="4205"><div><div><img src="https://cdn-images-1.medium.com/freeze/max/105/0*tbuNTABbmYCqu32H.?q=20" /><div class="readableLargeImageContainer"><img src="https://cdn-images-1.medium.com/max/2000/0*tbuNTABbmYCqu32H." /></div></figure><p id="48ea">Enzyme cannot find the result label because it doesn’t exist. Let’s add the label and attach it to our <em>parseEquation</em> output.</p><h4 id="0347">Implementation # 3</h4><p id="cb35">Note: <em>this</em> in <em>calculateValue</em> needs to be bound in the component constructor to access React’s <em>setState</em>.</p><p id="e156">I split off the <em>onClick</em> event into its own function, <em>calculateValue</em>. It takes the result of <em>parseEquation</em>, updates the React state, and displays that value inside a label with the class ‘result’. If we run our tests they should now pass.</p><p id="386a">We have successfully implemented the first tasks implementation. You can run the application by running ‘npm run dev’ and open localhost:8080 on a browser. Try it out!</p><p id="c14d">I just walked you through the basics of creating tests with React. You should now feel more comfortable with writing an initial test for a React application. I hope you also see some of the value in using TDD. In <a href="https://medium.com/@tribalscale/tutorial-on-testing-react-with-tdd-part-2-c50172bf272e" target="_blank">part 2</a>, I’ll build on our user story, show you how to implement more complex tests, and introduce more features from our test libraries. If you have any questions or thoughts, leave me a comment below!</p><figure id="8130"><div><div><img src="https://cdn-images-1.medium.com/freeze/max/105/1*skU3zYdPZZoxx2GH6ce0lA.png?q=20" /><div class="readableLargeImageContainer"><img src="https://cdn-images-1.medium.com/max/2000/1*skU3zYdPZZoxx2GH6ce0lA.png" /></div></figure><p id="c3a4"><em>One of TribalScale’s first employees, Lawton Spelliscy, is a Lead Agile Software Engineer at TribalScale. He’s currently helping TribalScale’s Transformation Services through defining and running the Engineering component with some of the biggest brands. A love of all things nerdy has led him down the dark path to programming. An oddball at heart, his interests also include hiking, travelling, musicals, board games, and what he calls ‘dancing’.</em></p><p id="2b60"><em>Connect with TribalScale on </em><a href="http://twitter.com/tribalscale" target="_blank"><em>Twitter</em></a><em>, </em><a href="http://facebook.com/tribalscale" target="_blank"><em>Facebook</em></a><em> & </em><a href="https://www.linkedin.com/company/tribalscale" target="_blank"><em>LinkedIn</em></a><em>! Visit our </em><a href="http://www.tribalscale.com/" target="_blank"><em>website</em></a><em> to learn more about us!</em></p>